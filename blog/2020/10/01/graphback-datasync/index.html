<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<title data-react-helmet="true">Rising above GraphQL Subscriptions with Graphback DataSync | Graphback</title><meta data-react-helmet="true" property="og:title" content="Rising above GraphQL Subscriptions with Graphback DataSync | Graphback"><meta data-react-helmet="true" name="description" content="GraphQL Subscriptions are a perfect fit for situations where users like to receive instant updates for some specific types of data. Subscriptions are very flexible and allow developers to connect directly to the stream of the changes generated on the server side."><meta data-react-helmet="true" property="og:description" content="GraphQL Subscriptions are a perfect fit for situations where users like to receive instant updates for some specific types of data. Subscriptions are very flexible and allow developers to connect directly to the stream of the changes generated on the server side."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:image" content="https://graphback.dev/img/logo.png"><meta data-react-helmet="true" property="twitter:image" content="https://graphback.dev/img/logo.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Rising above GraphQL Subscriptions with Graphback DataSync"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.e6205f81.css">
<link rel="preload" href="/styles.92fc8b64.js" as="script">
<link rel="preload" href="/runtime~main.b9db4627.js" as="script">
<link rel="preload" href="/main.a30571dc.js" as="script">
<link rel="preload" href="/1.6141f372.js" as="script">
<link rel="preload" href="/2.73aea2c0.js" as="script">
<link rel="preload" href="/ccc49370.e5d74cb7.js" as="script">
<link rel="preload" href="/50431a98.a600f8bc.js" as="script">
<link rel="preload" href="/d85a8383.85460b14.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Graphback Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.png" alt="Graphback Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Graphback</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduction">1.0</a></li><li><a class="dropdown__link" href="/docs/0.16.x/introduction">0.16.x</a></li><li><a class="dropdown__link" href="/docs/0.15.x/introduction">0.15.x</a></li><li><a class="dropdown__link" href="/docs/0.14.x/introduction">0.14.x</a></li><li><a class="dropdown__link" href="/docs/next/introduction">Master/Unreleased</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/aerogear/graphback" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"> </a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Graphback Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.png" alt="Graphback Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Graphback</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" href="/docs/introduction">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.16.x/introduction">0.16.x</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.15.x/introduction">0.15.x</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.14.x/introduction">0.14.x</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/introduction">Master/Unreleased</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/aerogear/graphback" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"> </a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_3I7I thin-scrollbar"><h3 class="sidebarItemTitle_2Dv3">Recent posts</h3><ul class="sidebarItemList_1RlG"><li class="sidebarItem_Hxgp"><a class="sidebarItemLink_3ppv" href="/blog/2020/10/01/announcing-graphback-1.0">Announcing the Release of Graphback 1.0</a></li><li class="sidebarItem_Hxgp"><a aria-current="page" class="sidebarItemLink_3ppv sidebarItemLinkActive_3XUi" href="/blog/2020/10/01/graphback-datasync">Rising above GraphQL Subscriptions with Graphback DataSync</a></li><li class="sidebarItem_Hxgp"><a class="sidebarItemLink_3ppv" href="/blog/2020/07/22/new-graphback-release-0-14">Improving the GraphQL experience with Graphback 0.14</a></li></ul></div></div><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Rising above GraphQL Subscriptions with Graphback DataSync</h1><div class="margin-vert--md"><time datetime="2020-10-01T00:00:00.000Z" class="blogPostDate_3bQP">October 1, 2020  · 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/ssd71" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/20183094?s=460&amp;u=dc7003f2886fbefe348ab88db9db6087fd23cb29&amp;v=4" alt="Shibani Shankar Dash"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/ssd71" target="_blank" rel="noreferrer noopener">Shibani Shankar Dash</a></h4><small class="avatar__subtitle">Aerogear community contributor</small></div></div></header><section class="markdown"><p>GraphQL Subscriptions are a perfect fit for situations where users like to receive instant updates for some specific types of data. Subscriptions are very flexible and allow developers to connect directly to the stream of the changes generated on the server side.
Subscriptions deliver delta updates to the client only when clients are subscribed. To receive partial updates after an application is restarted developers can use the concept of delta queries.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="delta-queries"></a>Delta queries<a class="hash-link" href="#delta-queries" title="Direct link to heading">#</a></h2><p>Delta queries are a concept that allow users to perform a query that will return partial data based on a specific separator that is usually represented as a sequence or timestamp or any date series that will separate a sorted dataset into data we have seen and a delta that should be returned to clients.</p><p><img src="/assets/images/syncdiagram-97eef2ef5cf682e7930093f5f656faac.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="delete-is-challenging"></a>Delete is challenging<a class="hash-link" href="#delete-is-challenging" title="Direct link to heading">#</a></h2><p>Not every dataset can support delta queries. Every deletion of the data will remove it from the database which means that sorting and splitting the dataset to retrieve updates will destroy it.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="conflict-resolution"></a>Conflict resolution<a class="hash-link" href="#conflict-resolution" title="Direct link to heading">#</a></h2><p>In an offline-first application, where a client may often switch between being online and offline, conflicts between client-side and server-side data are almost guaranteed to occur. It is of utmost importance these conflicts are detected and some mechanism is in place to resolve these conflicts.</p><p><img src="/assets/images/syncdiagram-97eef2ef5cf682e7930093f5f656faac.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="solution"></a>Solution?<a class="hash-link" href="#solution" title="Direct link to heading">#</a></h3><p><img src="https://i.memeful.com/memes/R8nXE1b/Matrix-Morpheus.jpg"></p><ul><li>Stop deleting data in the table to introduce soft deletes </li><li>Have separate table for delete operations and merging results when sending data to clients</li><li>Have separate table that can be used to query diffs </li></ul><p>These concepts are very common and are often needed when building applications that will consume large amount of data that needs to be available on the client - especially when the client is designed to work without network connectivity.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="graphql-crud-spec-for-delta-queries"></a>GraphQL CRUD spec for delta queries<a class="hash-link" href="#graphql-crud-spec-for-delta-queries" title="Direct link to heading">#</a></h3><p>That is why we have built and included delta operations as well as conflict resolution into <a href="https://graphqlcrud.org/" target="_blank" rel="noopener noreferrer">GraphQLCRUD</a> specification.
Today we are glad to announce that DeltaQueries as well as Server-side Conflict Resolution are officially available as part of the Graphback.dev project that implements this specification.
Graphback is a library that lets you auto-generate your GraphQL Data layer at runtime. The latest release of Graphback provides support for delta queries as well as server-side conflict resolution.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="what-is-datasync"></a>What is DataSync?<a class="hash-link" href="#what-is-datasync" title="Direct link to heading">#</a></h2><p><a href="/blog/2020/docs/datasync/intro.md">DataSync</a> is short for data synchronization and that’s what we set out to do with this package. When a GraphQL client goes offline for sometime, e.g. because of a poor network connection, the data cached by the client can get outdated pretty fast and without a live subscription to fetch those changes it becomes imperative that a client provide some way to be up to date with the data as soon as it comes back online. That is DataSync.</p><p><a href="/blog/2020/docs/datasync/intro.md">DataSync</a>is the reference implementation for the Delta Queries and Conflict Resolution extension of the <a href="https://graphqlcrud.org/" target="_blank" rel="noopener noreferrer">GraphQLCRUD</a> spec.</p><p><a href="/blog/2020/docs/datasync/intro.md">DataSync</a> achieves this by providing a special type of query we like to call a delta query and extends the existing update resolvers to give out of the box server-side Conflict Resolution.
Delta Queries</p><p>A delta query is a GraphQL query that helps the client know what changed while they were offline. So as an example scenario if we were to fetch notes that were changed when we were offline, with DataSync this would go like:</p><div class="mdxCodeBlock_1XEh"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_3nn1">Example delta query</div><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-graphql codeBlock_3iAC thin-scrollbar codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">query</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  syncNotes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token attr-name" style="color:rgb(241, 250, 140)">lastSync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1590679886048</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token attr-name" style="color:rgb(241, 250, 140)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token attr-name" style="color:rgb(241, 250, 140)">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;e12jk12j4b214j1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      id</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      text</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      content</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      _lastUpdatedAt</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      _deleted</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="mdxCodeBlock_1XEh"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_3nn1">Example response</div><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json codeBlock_3iAC thin-scrollbar codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;syncNotes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;items&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;e12jk12j4b214j1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Weekly Agenda&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">&quot;content&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;All Done&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">&quot;_lastUpdatedAt&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1591852693075</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">&quot;_deleted&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;lastSync&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1591852700920&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;limit&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token null keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Notice that we not only get the required fields like id and text, but also <code>_lastUpdatedAt</code> as well as if the post was <code>_deleted</code>, all of which are automatically maintained by DataSync.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="server-side-conflict-resolution"></a>Server-side Conflict Resolution<a class="hash-link" href="#server-side-conflict-resolution" title="Direct link to heading">#</a></h2><p><img src="/assets/images/conflictresolution-4b1c5af32e35098cde8efdec85846c28.png"></p><p>Server-side Conflict resolution is the ability to resolve conflicts between the data that the client has, and the data present in the database. In offline-first applications, it is crucial to address availability problems to ensure the consistency of data between the server and the client. Graphback DataSync does this out of the box by maintaining a <code>_version</code> field and using it to track changes in data with delta tables that store intermediate versions of documents which can be used to implement their own conflict resolution strategies, on top of the DataSync provided strategies.</p><div class="mdxCodeBlock_1XEh"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_3nn1">Final schema when using server-side conflict resolution</div><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-graphql codeBlock_3iAC thin-scrollbar codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GraphbackObjectID</span><span class="token operator">!</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_lastUpdatedAt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GraphbackTimestamp</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Int</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">input</span><span class="token plain"> MutateCommentInput </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GraphbackObjectID</span><span class="token operator">!</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Int</span><span class="token operator">!</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>As it can be seen, when server-side conflict resolution is enabled, this changes the schema in two ways:</p><ul><li>Adding a <code>_version</code> field to the base GraphQL type</li><li>Adding a <code>_version</code> field to the Mutation Input type</li></ul><p>With this, a client can pass their version of the data and the server can detect inconsistencies between the client-side and server-side by using the <code>_version</code> field. The conflicts can then be resolved by a specified conflict resolution strategy. DataSync provides two conflict resolution strategies out of the box:</p><ul><li>ClientSideWins: The edits made by the client are never discarded and will always be persisted to the database</li><li>ServerSideWins: The fields edited by the client never overwrite fields that have been updated on the server</li></ul><p>In addition to this, custom conflict resolution strategies can also be built to suit specific use cases. All of this information and more can be found in the <a href="/blog/2020/docs/datasync/intro.md">DataSync docs</a>.</p><p>All of this can be easily setup with our DataSync enabled <a href="/blog/2020/docs/graphqlserve/graphqlserve.md">graphql-serve</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="setting-up-a-datasync-server"></a>Setting Up a DataSync server<a class="hash-link" href="#setting-up-a-datasync-server" title="Direct link to heading">#</a></h3><ul><li>Define your data model using GraphQL</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-graphql codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot; </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token directive function" style="color:rgb(80, 250, 123)">@model</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token directive function" style="color:rgb(80, 250, 123)">@datasync</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain">&quot;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> GraphbackObjectID</span><span class="token operator">!</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token attr-name" style="color:rgb(241, 250, 140)">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> String</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">scalar</span><span class="token plain"> </span><span class="token class-name">GraphbackObjectID</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This is going to be our data model. Notice that both types are annotated with <a href="/blog/2020/docs/model/annotations.md#model"><code>@model</code></a> and <a href="/blog/2020/docs/datasync/delta-queries.md/#annotate-the-required-models"><code>@datasync</code></a>. The former is required for Graphback to recognise model types and the latter is required to enable DataSync for a specific model.</p><p>Visit the <a href="/blog/2020/docs/datasync/intro.md">docs</a> for a complete reference to all Graphback supported annotations as well as a more involved introduction to DataSync.</p><p>Edit the data model as desired and move on.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-shell codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">npx graphql-serve serve model.graphql --datasync -p </span><span class="token number">4000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Navigate to <a href="http://localhost:4000/graphql" target="_blank" rel="noopener noreferrer">http://localhost:4000/graphql</a> and test out queries.
Be sure to check out our docs for tons of other cool things that you can do with Graphback and DataSync!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/graphql">graphql</a><a class="margin-horiz--sm" href="/blog/tags/graphback">graphback</a><a class="margin-horiz--sm" href="/blog/tags/graphqlcrud">graphqlcrud</a><a class="margin-horiz--sm" href="/blog/tags/graphql-js">graphql-js</a><a class="margin-horiz--sm" href="/blog/tags/nodejs">nodejs</a><a class="margin-horiz--sm" href="/blog/tags/datasync">datasync</a><a class="margin-horiz--sm" href="/blog/tags/graphql-subscriptions">graphql-subscriptions</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/10/01/announcing-graphback-1.0"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Announcing the Release of Graphback 1.0</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/07/22/new-graphback-release-0-14"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Improving the GraphQL experience with Graphback 0.14 »</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#delta-queries" class="table-of-contents__link">Delta queries</a></li><li><a href="#delete-is-challenging" class="table-of-contents__link">Delete is challenging</a></li><li><a href="#conflict-resolution" class="table-of-contents__link">Conflict resolution</a><ul><li><a href="#solution" class="table-of-contents__link">Solution?</a></li><li><a href="#graphql-crud-spec-for-delta-queries" class="table-of-contents__link">GraphQL CRUD spec for delta queries</a></li></ul></li><li><a href="#what-is-datasync" class="table-of-contents__link">What is DataSync?</a></li><li><a href="#server-side-conflict-resolution" class="table-of-contents__link">Server-side Conflict Resolution</a><ul><li><a href="#setting-up-a-datasync-server" class="table-of-contents__link">Setting Up a DataSync server</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/create-new-app">Getting started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/crud/overview">CRUD</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/plugins/overview">Plugins</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/commands">Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/releases">Releases</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/aerogear/graphback" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://discordapp.com/invite/mJ7j84m" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://aerogear.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="AeroGear Logo" src="/img/aerogear.png"></a></div><div>Copyright © 2020 AeroGear</div></div></div></footer></div>
<script src="/styles.92fc8b64.js"></script>
<script src="/runtime~main.b9db4627.js"></script>
<script src="/main.a30571dc.js"></script>
<script src="/1.6141f372.js"></script>
<script src="/2.73aea2c0.js"></script>
<script src="/ccc49370.e5d74cb7.js"></script>
<script src="/50431a98.a600f8bc.js"></script>
<script src="/d85a8383.85460b14.js"></script>
</body>
</html>